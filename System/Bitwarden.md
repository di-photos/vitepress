# 在群晖上搭建Bitwarden密码管理服务器

 

> 管理密码是很多人头痛的事，密码设置简单好记又不太安全，设置复杂又容易忘。为了解决这个难题，市面上出现了不少密码管理工具，帮助人们管理在各种平台、系统、网站、APP上设置的密码，比如1Password、Lastpass、KeePass等，不过绝大多数需要付费才能使用。本着能白嫖就绝不花一个子儿的原则，今天我就来介绍一个不需要花钱的密码管理器------`Bitwarden`

 

### 关于Bitwarden

`Bitwarden`是一款开源、跨平台的密码管理软件，它包括密码管理、密码生成和密码填入等功能。`Bitwarden`包含服务端和客户端，服务端就是为客户端提供数据加密存储和读写访问的服务，客户端支持Windows、macOS、Linux、Android、IOS、Web以及浏览器插件等所有主流平台，相当给力了！

最最重要的是，它不但提供商业化的服务，还可以进行私有化部署。也就是说，只要有条件，就可以搭建一套完全自己的密码管理系统，妈妈再也不用担心我记不住密码啦～～

### 搭建私有化服务

当然，搭建Bitwarden私有化服务可以在普通的个人电脑或云服务器操作，本文仅介绍如何在群晖Nas上搭建。

 

#### 1. 下载镜像

首先，你的群晖Nas得支持Docker，不支持的话就可以直接return了。

![image-20210126215847254](https://imgs.huluohu.com/blog/image-20210126215847254.png)

打开Docker，切换到注册表，在搜索框中输入`bitwarden`,搜索结果排在第一位的就是我们要下载的镜像

![image-20210126220032199](https://imgs.huluohu.com/blog/image-20210126220032199.png)

 

双击下载，选择标签为`latest`，即最新版本，等待下载完成即可。

![image-20210126220133497](https://imgs.huluohu.com/blog/image-20210126220133497.png)

 

#### 2. 配置和启动

- 下载完成后，点击映像,找到我们上面下载好的镜像，双击打开设置界面

  ![image-20210126220536042](https://imgs.huluohu.com/blog/image-20210126220536042.png)

  ![image-20210126220603128](https://imgs.huluohu.com/blog/image-20210126220603128.png)

- 点击高级设置，在常规设置中设置设置容器名称

  ![image-20210126220804019](https://imgs.huluohu.com/blog/image-20210126220804019.png)

- 切换到卷，将容器中的**/data**目录映射到本地目录，本地目录需要先创建

  ![image-20210126220938697](https://imgs.huluohu.com/blog/image-20210126220938697.png)

- 切换到端口设置,将容器的80和3012端口映射到本机端口，按照自己的实际需要修改本地端口的值

  ![image-20210126221245125](https://imgs.huluohu.com/blog/image-20210126221245125.png)

- 点击`应用`，返回引导页面，点击`下一步`，勾选`向导完成后运行此容器`后，点击`应用`按钮，即可启动容器。

- Bitwarden的服务端到这里就搭建完成了，切换容器页面，可以看到容器已经正常启动了，这时候我们在浏览器localhost:本机端口，即可打开Web管理页面。首次打开需要先创建一个账号，创建完成后使用账号和主密码即可登录。

  ![image-20210126223518575](https://imgs.huluohu.com/blog/image-20210126223518575.png)

  ![image-20210126223631361](https://imgs.huluohu.com/blog/image-20210126223631361.png)

   

#### 3. 外网访问设置

如果需要通过公网访问，需要路由器支持端口映射，然后在群晖上可以直接进行操作。在群晖上打开控制面板---外部访问----路由器配置，添加端口映射即可。

![image-20210126224449335](https://imgs.huluohu.com/blog/image-20210126224449335.png)

然后就可以通过公网IP+路由器端口访问Bitwarden的web管理界面了。

 

#### 4. 域名和HTTPS设置

Bitwarden是使用加密传输密码的，即使使用Http访问也很安全，不过现在很多浏览器、包括IOS系统，对Http不是很友好，所以最好把Https配置上。

配置Https前提是需要有自己的域名和TLS证书，TLS可以到阿里云、腾讯云等平台免费申请，一次一年有效期，到期需要自己再去续期。

域名需要自己去购买，这里就不多赘述了。

 

- 打开控制面板----安全性-证书，点击新增按钮，可以导入自己的证书或直接从Let' Encrypt申请证书，看自己需要。

  ![image-20210126225049507](https://imgs.huluohu.com/blog/image-20210126225049507.png)

- 点击应用程序门户---反向代理服务器，点新增按钮，添加反向代理

  来源中的协议选择https，主机名就是你的域名，端口设置一个与`Bitwarden`镜像中映射的本地端口不一样就行；建议启用HSTS和HTTP/2。

  目的地中的协议选择http即可，主机名输入`localhost`，端口即是`Bitwarden`镜像中映射的本地端口。

  ![image-20210126225450167](https://imgs.huluohu.com/blog/image-20210126225450167.png)

  点击确定后，就完成了反向代理的设置。然后回到`外网访问设置`中介绍的`路由器设置`中，把反向代理中设置的https端口映射到路由器的端口上。配置完成，现在就可以通过https+域名访问Bitwarden了。

   

### 使用客户端

!!! note "根据自己的需要可以下载相应平台的客户端，下面以浏览器插件为例，介绍如何进行设置。"

 

- 下载插件，Chrome可以到chrome商店搜索bitwarden下载，也可以到官网

  https://bitwarden.com/download/

  进行下载。

  ![image-20210126231104487](https://imgs.huluohu.com/blog/image-20210126231104487.png)

- 下载安装后，在浏览器工具栏可以看到Bitwarden的图标，单击图标，弹出设置页面

  ![image-20210126231237850](https://imgs.huluohu.com/blog/image-20210126231237850.png)

- 由于我们是私有化部署，需要先配置私有化服务的地址。点击左上角的⚙️图标，将我们上面配置好的Https域名+端口填入服务器URL中，点击保存。回到登录界面，点击登录，输入在Bitwarden服务上注册好的账号和密码，即可完成登录。

  ![image-20210126231753202](https://imgs.huluohu.com/blog/image-20210126231753202.png)

- 这样，当我们在浏览器上登录网站输入密码后，会提示保存密码到Bitwarden，下次重新登录相同网站后就可以直接从Bitwarden中读取密码，再也不用到处记密码啦！

 

